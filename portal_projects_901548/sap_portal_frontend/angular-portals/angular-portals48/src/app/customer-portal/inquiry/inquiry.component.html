<div class="inquiry-container">
  <div class="inquiry-content">
    <!-- Header Section -->
    <div class="header-section">
      <h2>Customer Inquiry List</h2>
      
      <!-- Controls -->
      <div class="controls">
        <!-- Search Container -->
        <div class="search-container">
          <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <input 
            type="text" 
            placeholder="Search inquiries..." 
            [(ngModel)]="searchTerm" 
            (input)="filterInquiries()"
            class="search-input">
          <button 
            *ngIf="searchTerm" 
            class="clear-btn" 
            (click)="clearSearch()"
            title="Clear search">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <!-- Refresh Button -->
          <button 
            class="action-btn refresh-btn" 
            (click)="refreshInquiries()"
            [disabled]="isLoading"
            title="Refresh data">
            <svg class="btn-icon" [class.spinning]="isLoading" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23 4 23 10 17 10"></polyline>
              <polyline points="1 20 1 14 7 14"></polyline>
              <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
            </svg>
            <span>Refresh</span>
          </button>

          <!-- Export Button -->
          <button 
            class="action-btn export-btn" 
            (click)="exportToExcel()"
            [disabled]="isExporting || filteredInquiries.length === 0"
            title="Export to Excel">
            <svg class="btn-icon" [class.spinning]="isExporting" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="12" y1="18" x2="12" y2="12"></line>
              <line x1="9" y1="15" x2="15" y2="15"></line>
            </svg>
            <span>Export</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div *ngIf="isLoading" class="loading-overlay">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading inquiries...</p>
    </div>

    <!-- Export Loading Overlay -->
    <div *ngIf="isExporting" class="export-overlay">
      <div class="export-spinner"></div>
      <p class="export-text">Exporting data...</p>
    </div>

    <!-- Table Section -->
    <div class="table-section">
      <div class="table-container" [class.loading]="isLoading">
        <table *ngIf="!isLoading && filteredInquiries.length > 0; else noData">
          <thead>
            <tr>
              <th>Inquiry No</th>
              <th>Date</th>
              <th>Type</th>
              <th>Net Value</th>
              <th>Currency</th>
              <th>Valid Date</th>
              <th>Item No</th>
              <th>Material</th>
              <th>Description</th>
              <th>Quantity</th>
              <th>UOM</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let inquiry of filteredInquiries">
              <td>{{ inquiry.vbeln }}</td>
              <td>{{ inquiry.erdat | date:'dd/MM/yyyy' }}</td>
              <td>{{ inquiry.auart }}</td>
              <td>{{ inquiry.netwr | currency:'EUR' }}</td>
              <td>{{ inquiry.waerk }}</td>
              <td>{{ inquiry.vdate | date:'dd/MM/yyyy' }}</td>
              <td>{{ inquiry.posnr }}</td>
              <td>{{ inquiry.matnr }}</td>
              <td>{{ inquiry.arktx }}</td>
              <td>{{ inquiry.kwmeng }}</td>
              <td>{{ inquiry.vrkme }}</td>
            </tr>
          </tbody>
        </table>

        <!-- No Data Template -->
        <ng-template #noData>
          <div class="no-data-container">
            <svg class="no-data-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <p><strong>No inquiries found</strong></p>
            <p *ngIf="searchTerm">Try adjusting your search criteria</p>
            <p *ngIf="!searchTerm">No inquiry data available at the moment</p>
            <button 
              *ngIf="searchTerm" 
              class="clear-search-action" 
              (click)="clearSearch()">
              Clear Search
            </button>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</div>